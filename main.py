from telethon import TelegramClient, events
import re


api_id = 27272508
api_hash = "fd910ebdfc761b86e5e2f143d71f45c0"
phone = "380507478894"

client = TelegramClient(phone, api_id, api_hash, system_version='4.16.30-vxCUSTOM')
client.parse_mode = 'html'

main_channel = -1001998091404

channels_for_grab = [
    -1001606401919, -1001949005395, -1001295005098, -1001660722954, -1001857132617, -1001322813943, -1001604013421,
    -1001350832778, -1001581519471, -1001177079955, -1001277862355, -1001325190160, -1001181579326, -1001543510066,
    -1001791271427, -1001389837789, -1001896345357, -1001233154810, -1001318459173, -1001983684965, -1001517199518,
    -1001786005753, -1001685123337, -1001529532603, -1001393712717, -1001674186593, -1001576305880, -1001751525601,
    -1001811247070, -1001371916046, -1001525543664, -1001290983142, -1001579208217, -1001673787979, -1001553038207,
    -1001244592602, -1001833426987, -1001904339991, -1001961266885, -1001380511806, -1002087504613, -1001450269392,
    -1001995902277, -1001583799495, -1001396331355, -1001769678468, -1001468922843, -1001452023334, -1001408008774,
    -1001209877193, -1001409517037, -1001401726033, -1001393249193, -1001180245715, -1001759178932, -1001308407014,
    -1001311408644, -1001988560722, -1001322813943, -1001438469067, -1001378319048, -1001137503644, -1001522112065,
    -1001958603264, -1001858407380, -1001901167371, -1001942218573, -1001986901421, -1001686223985, -1001536750942,
    -1001522404640, -1001279988735, -1001577681416, -1001683229213, -1001103156398, -1001424234017, -1001442869570,
    -1001140753536, -1001423054913, -1001729965353, -1001381656711, -1001086942006, -1001207633109, -1001576902190,
    -1001422370788, -1001301307794, -1001643644995, -1001539612839, -1001356440450, -1001242700456, -1001711204716,
    -1001649965876, -1001326163489, -1001867981813, -1002048467477, -1001900586453, -1001900312562, -1001851528268,
    -1001851528268, -1001648110014, -1001387780004, -1001882052882, -1001966452863, -1001841275366, -1001231491534,
    -1001493720845, -1001735416346, -1001971870226, -1001626816653, -1001780713808, -1001446774454, -1001165905101,
    -1002081301410, -1001266391544, -1001998091404, -1001630692598, -1002071167364, -1001628904309, -1002081093102,
    -1001411960688, -1001501551131, -1001742443873, -1001911327646, -1002126889584, -1001344723295, -1001703968875,
    -1001783089462, -1002092598460, -1001744248528, -1001811247070, -1001907137791, -1001921958123,
    -1001318459173 - 1001967244124, -1001603058549, -1001995528971, -1001718809245, -1001642613337, -1001700979910,
    -1002058207944, -1001266391544, -1001546754435, -1002108673713, -1001983684965, -1001302245433,-1001073413076,-1001242131069,-1001614071907,-1002002937330,-1001350990445,-1001533012078,-1001922578442,-1001775526209,-1001793252732,-1001636533126,-1001318459173,-1001967244124,-1001603058549,-1001995528971,-1001718809245,-1001642613337,-1001700979910,-1002058207944,-1001266391544,-1001546754435,-1002108673713,-1001983684965,-1001931668735,-1001888053021,-1001856332402,-1001839754492,-1001851384098,-1001722026160,-1001900312562,-1001923937471,-1001827824448,-1001995902277,-1001671520322,-1001392526699,-1001892565016,-1001518976065,-1001610893993,-1001832470426,-1001729380520,-1001456918065,-1001661883373,-1001597716260,-1001607950564,-1001983760383,-1001989828866,-1001606401919,-1001295005098,-1001660722954,-1001857132617,-1001322813943,-1001604013421,-1001350832778,-1001581519471,-1001177079955,-1001277862355,-1001325190160,-1001488285421,-1001181579326,-1001543510066,-1001791271427,-1001389837789,-1001896345357,-1001233154810,-1001318459173,-1001983684965,-1001517199518,-1001786005753,-1001685123337,-1001529532603,-1001393712717,-1001674186593,-1001576305880,-1001751525601,-1001811247070,-1001371916046,-1001290983142,-1001579208217,-1001673787979,-1001553038207,-1001244592602,-1001833426987,-1001904339991,-1001961266885,-1001380511806,-1001450269392,-1001396331355,-1001769678468,-1001468922843,-1001452023334,-1001209877193,-1001409517037,-1001401726033,-1001393249193,-1001180245715,-1001759178932,-1001308407014,-1001311408644,-1001988560722,-1001322813943,-1001438469067,-1001378319048,-1001137503644,-1001522112065,-1001958603264,-1001901167371,-1001942218573,-1001986901421,-1002063488303,-1001686223985,-1001536750942,-1001522404640,-1001279988735,-1001577681416,-1001683229213,-1001103156398,-1001424234017,-1001442869570,-1001140753536,-1001423054913,-1001729965353,-1001381656711,-1001086942006,-1001207633109,-1001576902190,-1001422370788,-1001301307794,-1001643644995,-1001539612839,-1001356440450,-1001242700456,-1001711204716,-1001326163489,-1001867981813,-1002048467477,-1001900586453,-1001851528268,-1001851528268,-1001648110014,-1001387780004,-1001882052882,-1001966452863,-1001841275366,-1001231491534,-1001493720845,-1001735416346,-1001971870226,-1001626816653,-1001780713808,-1001755876485,-1002081301410,-1001266391544,-1001998091404,-1001630692598,-1002071167364,-1002081093102,-1001930451794,-1001501551131,-1001742443873,-1001911327646,-1002126889584,-1001344723295,-1001783089462,-1002092598460,-1001888053021,-1001921958123,-1001302245433,-1001073413076,-1001242131069,-1001614071907,-1002002937330,-1001350990445,-1001533012078,-1001775526209,-1001793252732,-1001636533126,-1001967244124,-1001603058549,-1001995528971,-1001718809245,-1001569089124,-1001700979910,-1002058207944,-1001266391544,-1001546754435,-1002108673713,-1001931668735,-1001856332402,-1001839754492,-1001851384098,-1001722026160,-1001900312562,-1001923937471,-1001827824448,-1001671520322,-1001392526699,-1001892565016,-1001518976065,-1001610893993,-1001832470426,-1001755064566,-1001456918065,-1001661883373,-1001597716260,-1001561942082,-1002039831940,-1001875638199,-1001673787979,-1001667447452,-1001935818141,-1001901263221,-1001849045841,-1001877806179,-1001835949843,-1001851376857,-1001109660903,-1001591264082,-1001259124566,-1001766050210,-1002034276689,-1001918747290,-1002097903821,-1001176453176,-1001600915190,-1001528207982,-1001741389790,-1002066098409,-1001593982841,-1001817625686,-1001316448339,-1001561913115,-1001274514549,-1001869173929,-1001840506997,-1001567518920,-1001644656268,-1002069903934,-1001701250221,-1001560511812,-1001913702354,-1001713610894,-1001153086394,-1002037215613,-1001749317622,-1001488285421,-1001753051914,-1001312996868,-1001204280980,-1001610165996,-1001679277119,-1001907137791,-1001628904309,-1001873492727,-1002140612841,-1001889823464,-1001500911313,-1001989828866,-1001949005395,-1001589831805,-1001878083488,-1001976579456,-1001649965876,-1001756820909,-1001669794334,-1001402119388,-1002025572916,-1001446774454,-1001983760383,-1001650734552,-1001881080094,-1001590683360,-1001534917501,-1001858407380,-1001772115937,-1001834988286,-1001900312562,-1001747188464,-1002132670380,-1001963513784,-1002086760752]



async def check_links(text):
    words = ['t.me/']
    chk_pat = '(?:{})'.format('|'.join(words))
    return bool(re.search(chk_pat, text, flags=re.I))


@client.on(events.NewMessage(chats=channels_for_grab))
async def my_event_handler(event):
    text = str(event.message.text)
    check_linkss = await check_links(text)
    if check_linkss:
        if event.message:
            try:
                # await client.send_file(main_channel, file=event.message, caption=text)
                await client.forward_messages(main_channel, messages=event.message)
            except:
                try:
                    await client.send_file(main_channel, file=event.message, caption=text)
                except:
                    try:
                        await client.send_message(main_channel, text)
                    except:
                        pass
    else:
        return

client.start()
client.run_until_disconnected()
